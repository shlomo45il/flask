# תהליכים עסקיים במודול המלאי

מסמך זה מתאר בפירוט את התהליכים העסקיים העיקריים במודול המלאי ואת הממשקים שלהם עם המערכת.

## 1. תהליך קבלת מלאי

### תיאור כללי
תהליך קבלת מלאי מתרחש כאשר מוצרים חדשים נכנסים למחסן. זה יכול להיות כתוצאה מהזמנת רכש, העברה בין מחסנים, החזרה מלקוח או ייצור עצמי.

### תהליך עבודה
1. **קבלת מידע** - קבלת מידע על המוצרים שהתקבלו, כמויות ופרטים נוספים
2. **בדיקת איכות** (אופציונלי) - בדיקת המוצרים שהתקבלו בהתאם לדרישות האיכות
3. **הזנת הנתונים למערכת** - הזנת פרטי המוצרים שהתקבלו
   - מזהה מוצר
   - כמות
   - מיקום במחסן
   - מספר אצווה (אופציונלי)
   - תאריך תפוגה (אופציונלי)
   - מזהה עסקת רכש (אופציונלי)
4. **עדכון מלאי** - המערכת מעדכנת את כמויות המלאי
5. **תיעוד** - המערכת יוצרת תנועת מלאי מסוג "קבלה"

### טכני
לביצוע פעולת קבלת מלאי, יש לשלוח בקשת POST ל-`/api/v1/inventory/receive` עם הנתונים הבאים:
```json
{
  "product_id": 123,
  "location_id": 456,
  "quantity": 10,
  "batch_number": "LOT123",
  "expiry_date": "2024-12-31",
  "reference": "PO-789",
  "notes": "התקבל מספק X",
  "created_by": 1001
}
```

### שילוב עם מודולים אחרים
- **מודול רכש** - קבלת מלאי יכולה להיות מקושרת להזמנת רכש
- **מודול ייצור** - מוצרים מוגמרים נכנסים למלאי בסיום תהליך ייצור

## 2. תהליך הוצאת מלאי

### תיאור כללי
תהליך הוצאת מלאי מתרחש כאשר מוצרים יוצאים מהמחסן. זה יכול להיות כתוצאה ממכירה, העברה, שימוש בייצור או פסילה.

### תהליך עבודה
1. **יצירת בקשה** - יצירת בקשה להוצאת מוצרים
2. **בחירת מוצרים** - בחירת המוצרים להוצאה וכמויות
3. **בחירת מיקום** - בחירת המיקום ממנו יש להוציא את המוצרים
4. **בדיקת זמינות** - המערכת בודקת האם המוצרים זמינים בכמות הנדרשת
5. **עדכון מלאי** - המערכת מעדכנת את כמויות המלאי
6. **תיעוד** - המערכת יוצרת תנועת מלאי מסוג "הוצאה"

### טכני
לביצוע פעולת הוצאת מלאי, יש לשלוח בקשת POST ל-`/api/v1/inventory/issue` עם הנתונים הבאים:
```json
{
  "product_id": 123,
  "location_id": 456,
  "quantity": 5,
  "batch_number": "LOT123",
  "reference": "SO-456",
  "notes": "הזמנת לקוח",
  "created_by": 1001
}
```

### שילוב עם מודולים אחרים
- **מודול מכירות** - הוצאת מלאי מקושרת להזמנת לקוח
- **מודול ייצור** - חומרי גלם יוצאים מהמלאי עבור הליך ייצור

## 3. תהליך העברת מלאי

### תיאור כללי
תהליך העברת מלאי מאפשר להעביר מוצרים בין מיקומים שונים במחסן או בין מחסנים שונים.

### תהליך עבודה
1. **יצירת בקשת העברה** - יצירת בקשה להעברת מוצרים
2. **בחירת מוצרים** - בחירת המוצרים להעברה וכמויות
3. **בחירת מיקום מקור ויעד** - בחירת המיקום ממנו יועברו המוצרים והמיקום אליו יועברו
4. **בדיקת זמינות** - המערכת בודקת האם המוצרים זמינים במיקום המקור
5. **ביצוע העברה** - המערכת מבצעת את העברת המלאי
   - הורדת הכמות במיקום המקור
   - הוספת הכמות במיקום היעד
   - יצירת תנועות מלאי מתאימות

### טכני
לביצוע פעולת העברת מלאי, יש לשלוח בקשת POST ל-`/api/v1/inventory/transfer` עם הנתונים הבאים:
```json
{
  "product_id": 123,
  "source_location_id": 456,
  "target_location_id": 789,
  "quantity": 5,
  "batch_number": "LOT123",
  "reference": "TR-101",
  "notes": "העברה למחסן משני",
  "created_by": 1001
}
```

## 4. תהליך ספירת מלאי

### תיאור כללי
תהליך ספירת מלאי מאפשר לבצע התאמה בין הכמויות הרשומות במערכת לבין הכמויות בפועל במחסן.

### תהליך עבודה
1. **הכנת רשימות ספירה** - יצירת רשימות ספירה לפי מיקומים/מוצרים
2. **ביצוע ספירה** - ספירת המוצרים בפועל
3. **הזנת תוצאות** - הזנת הכמויות שנספרו
4. **ניתוח פערים** - המערכת מחשבת את הפערים בין הכמויות במערכת לכמויות בפועל
5. **אישור התאמות** - אישור ההתאמות הנדרשות
6. **ביצוע התאמות** - המערכת מעדכנת את כמויות המלאי בהתאם
7. **תיעוד** - המערכת יוצרת תנועות מלאי מסוג "התאמה"

### טכני
לביצוע התאמת מלאי, יש לשלוח בקשת POST ל-`/api/v1/inventory/adjust` עם הנתונים הבאים:
```json
{
  "product_id": 123,
  "location_id": 456,
  "new_quantity": 7,
  "batch_number": "LOT123",
  "reason": "ספירת מלאי",
  "reference": "COUNT-202",
  "notes": "התאמה לאחר ספירה",
  "created_by": 1001
}
```

## 5. ניטור והתראות מלאי

### תיאור כללי
המערכת מנטרת באופן שוטף את רמות המלאי ומספקת התראות במקרים של רמת מלאי נמוכה או חריגה אחרת.

### סוגי התראות
1. **מלאי מתחת לרמה מינימלית** - כאשר כמות המלאי יורדת מתחת לרמה המינימלית שהוגדרה
2. **מלאי שעומד לפוג בקרוב** - עבור מוצרים עם תאריך תפוגה שמתקרב

### טכני
לקבלת התראות מלאי, יש לשלוח בקשת GET ל-`/api/v1/inventory/alerts`.

לקבלת פריטי מלאי שעומדים לפוג בקרוב, יש לשלוח בקשת GET ל-`/api/v1/inventory/expiring?days=30`.

## 6. דוחות מלאי

### תיאור כללי
המערכת מספקת מגוון דוחות מלאי לצורך ניתוח וקבלת החלטות.

### סוגי דוחות
1. **דוח מלאי נוכחי** - מצב המלאי הנוכחי לפי מוצרים ומיקומים
2. **דוח תנועות מלאי** - היסטוריית תנועות מלאי לפי תקופה/מוצר/מיקום
3. **דוח מלאי איטי** - מוצרים שלא היו בהם תנועות תקופה ארוכה
4. **דוח ערך מלאי** - ערך המלאי הנוכחי לפי עלות/מחיר מכירה
5. **דוח התראות** - ריכוז התראות מלאי פעילות

### שילוב עתידי
בגרסאות הבאות של המערכת, יתווספו יכולות נוספות כגון:
1. **חיזוי מלאי** - חיזוי רמות מלאי עתידיות על בסיס נתוני העבר
2. **המלצות לרכש** - המלצות אוטומטיות להזמנות רכש
3. **ניתוח ABC** - סיווג המלאי לפי ערך/תדירות שימוש
4. **ממשק לסורקים** - תמיכה בסריקת ברקודים לניהול מלאי 