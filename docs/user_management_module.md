# מודול ניהול משתמשים - תיעוד מפורט

## מטרת המודול
מודול ניהול המשתמשים מיועד לספק תשתית מקיפה לניהול כל סוגי המשתמשים במערכת המודולרית לניהול עסק. המודול מאפשר ניהול מנהלים, עובדים, לקוחות וספקים תחת מערכת אחידה, תוך שמירה על הפרדה לוגית ביניהם.

## עקרונות מנחים

### 1. אבטחה ופרטיות
- **הרשאות מדורגות**: מערכת הרשאות מבוססת תפקידים המאפשרת גישה מדויקת למשאבים.
- **תיעוד פעולות**: כל פעולה במערכת מתועדת ביומן פעילות עם פרטי המשתמש, סוג הפעולה, מועד הביצוע ו-IP.
- **אימות דו-שלבי**: תמיכה באימות דו-שלבי למשתמשים רגישים (מנהלים ועובדים).
- **מדיניות סיסמאות**: אכיפת מדיניות סיסמאות חזקות ותזכורות לשינוי תקופתי.

### 2. גמישות והרחבה
- **מודל משתמשים מורחב**: הרחבת מודל המשתמש הבסיסי של Django לתמיכה בסוגי משתמשים שונים.
- **פרופילים ייעודיים**: פרופילים ייחודיים לכל סוג משתמש (לדוגמה: פרופיל ספק).
- **תמיכה במודולים**: אינטגרציה עם מודולים אחרים במערכת (מלאי, הזמנות, דוחות וכו').
- **הרחבה עתידית**: תכנון המאפשר הוספת סוגי משתמשים ותכונות חדשות בעתיד.

### 3. חוויית משתמש
- **ממשק ניהול אחיד**: ממשק אחיד לניהול כל סוגי המשתמשים.
- **התאמה אישית**: אפשרות להתאמה אישית של הרשאות ותפקידים.
- **תמיכה רב-לשונית**: תמיכה בעברית ושפות נוספות.
- **נגישות**: עמידה בתקני נגישות מקובלים.

### 4. יעילות תפעולית
- **אוטומציה**: יצירה אוטומטית של פרופילים מתאימים בעת הוספת משתמש חדש.
- **ניהול מרוכז**: ניהול מרכזי של כל סוגי המשתמשים.
- **ייבוא/ייצוא**: תמיכה בייבוא וייצוא נתוני משתמשים.
- **התראות**: מערכת התראות לאירועים חריגים (ניסיונות כניסה כושלים, שינויי הרשאות וכו').

## מבנה המודול

### מודלים מרכזיים

#### 1. UserProfile
מרחיב את מודל המשתמש הבסיסי של Django ומוסיף שדות ייעודיים:
- סוג משתמש (מנהל, עובד, לקוח, ספק)
- פרטי קשר (טלפון)
- פרטי תפקיד ומחלקה
- תמונת פרופיל
- מעקב אחר התחברויות (IP אחרון)
- סטטוס פעילות

#### 2. SupplierProfile
מודל ייעודי לניהול פרטי ספקים:
- פרטי חברה (שם, מספר עוסק, מספר מס)
- כתובת
- איש קשר
- תנאי תשלום ומסגרת אשראי
- דירוג ספק
- הערות

#### 3. Permission
מודל להגדרת הרשאות מותאמות אישית:
- סוגי הרשאות (צפייה, הוספה, עריכה, מחיקה, אישור, ייצוא, ייבוא)
- חלוקה למודולים (מלאי, הזמנות, לקוחות, ספקים, דוחות, משתמשים, הגדרות)
- קוד ייחודי לכל הרשאה
- תיאור מפורט

#### 4. Role
מודל להגדרת תפקידים במערכת:
- שם תפקיד
- קישור להרשאות
- תיאור
- סטטוס פעילות

#### 5. UserRole
מודל המקשר בין משתמשים לתפקידים:
- קישור למשתמש
- קישור לתפקיד
- מידע על מי הקצה את התפקיד ומתי

#### 6. UserActivityLog
מודל לניהול היסטוריית פעולות משתמשים:
- סוגי פעולות (התחברות, התנתקות, יצירה, עדכון, מחיקה, שינוי סיסמה, שינוי תפקיד, שינוי סטטוס)
- תיאור הפעולה
- מידע על IP ודפדפן
- חותמת זמן

## תהליכים עיקריים

### 1. רישום משתמש חדש
1. יצירת משתמש בסיסי
2. יצירה אוטומטית של פרופיל משתמש
3. זיהוי סוג המשתמש (לפי שם משתמש או בחירה מפורשת)
4. יצירת פרופיל ייעודי בהתאם לסוג המשתמש (למשל, פרופיל ספק)
5. הקצאת תפקידים והרשאות ברירת מחדל

### 2. ניהול הרשאות
1. יצירת הרשאות בסיסיות לכל מודול
2. הגדרת תפקידים והקצאת הרשאות לתפקידים
3. שיוך משתמשים לתפקידים
4. בדיקת הרשאות בזמן אמת

### 3. מעקב אחר פעילות
1. תיעוד אוטומטי של פעולות משתמשים
2. שמירת מידע על IP ודפדפן
3. יצירת דוחות פעילות
4. התראות על פעילות חריגה

## ממשקים למודולים אחרים

### 1. מודול מלאי
- הרשאות לצפייה ועדכון מלאי
- קישור ספקים למוצרים

### 2. מודול הזמנות
- קישור לקוחות להזמנות
- קישור ספקים להזמנות רכש

### 3. מודול דוחות
- הרשאות לצפייה והפקת דוחות
- דוחות ייעודיים לפעילות משתמשים

### 4. מודול הגדרות
- ניהול הגדרות מערכת
- הגדרות אבטחה

## שיקולי אבטחה נוספים

1. **הצפנת מידע רגיש**: כל המידע הרגיש (כמו פרטי תשלום) מוצפן בבסיס הנתונים.
2. **הגנה מפני התקפות**: מניעת התקפות SQL Injection, XSS, CSRF וכו'.
3. **מדיניות GDPR**: עמידה בדרישות תקנות הגנת המידע.
4. **גיבוי ושחזור**: מנגנוני גיבוי ושחזור נתוני משתמשים.

## תוכניות עתידיות

1. **אינטגרציה עם מערכות חיצוניות**: חיבור למערכות CRM, ERP וכו'.
2. **אימות ביומטרי**: תמיכה באימות ביומטרי למשתמשים רגישים.
3. **ניתוח התנהגות**: זיהוי דפוסי התנהגות חריגים לשיפור האבטחה.
4. **פורטל ספקים/לקוחות**: ממשקים ייעודיים לספקים ולקוחות.

## סיכום

מודול ניהול המשתמשים מהווה תשתית קריטית למערכת המודולרית לניהול עסק. המודול מספק מענה מקיף לניהול כל סוגי המשתמשים, תוך שמירה על אבטחה, גמישות ויעילות תפעולית. התכנון המודולרי מאפשר הרחבה עתידית והתאמה לצרכים משתנים של העסק. 